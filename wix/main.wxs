<?xml version='1.0' encoding='windows-1252'?>
<!--
  WiX installer source for smb-watch.
  UpgradeCode MUST NOT be changed - it identifies this product across all versions.
  UpgradeCode: D802E510-9F08-408B-BFFD-B0B491E7F908
-->
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>

    <?if $(sys.BUILDARCH) = x64 or $(sys.BUILDARCH) = arm64 ?>
        <?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?>
    <?else ?>
        <?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?>
    <?endif ?>

    <Product
        Id='*'
        Name='smb-watch'
        UpgradeCode='D802E510-9F08-408B-BFFD-B0B491E7F908'
        Manufacturer='mtamaramu'
        Language='1033'
        Codepage='1252'
        Version='$(var.Version)'>

        <Package
            Id='*'
            Keywords='Installer'
            Description='Monitor an SMB share for file changes and upload via HTTP'
            Manufacturer='mtamaramu'
            InstallerVersion='450'
            Languages='1033'
            Compressed='yes'
            InstallScope='perMachine'
            SummaryCodepage='1252'
            Platform='x64'/>

        <MajorUpgrade
            Schedule='afterInstallInitialize'
            DowngradeErrorMessage='A newer version of smb-watch is already installed. Setup will now exit.'/>

        <Media Id='1' Cabinet='media1.cab' EmbedCab='yes' DiskPrompt='CD-ROM #1'/>
        <Property Id='DiskPrompt' Value='smb-watch Installation'/>

        <Directory Id='TARGETDIR' Name='SourceDir'>
            <Directory Id='$(var.PlatformProgramFilesFolder)'>
                <Directory Id='APPLICATIONFOLDER' Name='smb-watch'>

                    <Component Id='smb_watch_exe' Guid='80CABB41-7A19-42EE-9180-E10413843956'>
                        <File
                            Id='smb_watch_exe'
                            Name='smb-watch.exe'
                            DiskId='1'
                            Source='$(var.CargoTargetBinDir)\smb-watch.exe'
                            KeyPath='yes'/>
                    </Component>

                </Directory>
            </Directory>
        </Directory>

        <Feature
            Id='Application'
            Title='smb-watch'
            AllowAdvertise='no'
            Display='expand'
            Level='1'
            ConfigurableDirectory='APPLICATIONFOLDER'>
            <ComponentRef Id='smb_watch_exe'/>
        </Feature>

    </Product>
</Wix>
